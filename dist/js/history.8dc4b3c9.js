(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["history"],{"02b6":function(e,t,s){"use strict";s("4b33")},"1e5a":function(e,t,s){"use strict";var n=s("23e7"),a=s("9961"),i=s("5320"),r=s("dad2"),o=!r("symmetricDifference")||!i("symmetricDifference");n({target:"Set",proto:!0,real:!0,forced:o},{symmetricDifference:a})},"1e70":function(e,t,s){"use strict";var n=s("23e7"),a=s("a5f7"),i=s("d039"),r=s("dad2"),o=!r("difference",(function(e){return 0===e.size})),c=o||i((function(){var e={size:1,has:function(){return!0},keys:function(){var e=0;return{next:function(){var s=e++>1;return t.has(1)&&t.clear(),{done:s,value:2}}}}},t=new Set([1,2,3,4]);return 3!==t.difference(e).size}));n({target:"Set",proto:!0,real:!0,forced:c},{difference:a})},"271a":function(e,t,s){"use strict";var n=s("cb2d"),a=s("e330"),i=s("577e"),r=s("d6d6"),o=URLSearchParams,c=o.prototype,l=a(c.getAll),u=a(c.has),d=new o("a=1");!d.has("a",2)&&d.has("a",void 0)||n(c,"has",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return u(this,e);var n=l(this,e);r(t,1);var a=i(s),o=0;while(o<n.length)if(n[o++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},"384f":function(e,t,s){"use strict";var n=s("e330"),a=s("5388"),i=s("cb27"),r=i.Set,o=i.proto,c=n(o.forEach),l=n(o.keys),u=l(new r).next;e.exports=function(e,t,s){return s?a({iterator:l(e),next:u},t):c(e,t)}},"395e":function(e,t,s){"use strict";var n=s("dc19"),a=s("cb27").has,i=s("8e16"),r=s("7f65"),o=s("5388"),c=s("2a62");e.exports=function(e){var t=n(this),s=r(e);if(i(t)<s.size)return!1;var l=s.getIterator();return!1!==o(l,(function(e){if(!a(t,e))return c(l,"normal",!1)}))}},"4b33":function(e,t,s){},5320:function(e,t,s){"use strict";e.exports=function(e){try{var t=new Set,s={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},n=t[e](s);return 1===n.size&&4===n.values().next().value}catch(a){return!1}}},5388:function(e,t,s){"use strict";var n=s("c65b");e.exports=function(e,t,s){var a,i,r=s?e:e.iterator,o=e.next;while(!(a=n(o,r)).done)if(i=t(a.value),void 0!==i)return i}},5494:function(e,t,s){"use strict";var n=s("83ab"),a=s("e330"),i=s("edd0"),r=URLSearchParams.prototype,o=a(r.forEach);n&&!("size"in r)&&i(r,"size",{get:function(){var e=0;return o(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"68df":function(e,t,s){"use strict";var n=s("dc19"),a=s("8e16"),i=s("384f"),r=s("7f65");e.exports=function(e){var t=n(this),s=r(e);return!(a(t)>s.size)&&!1!==i(t,(function(e){if(!s.includes(e))return!1}),!0)}},"72c3":function(e,t,s){"use strict";var n=s("23e7"),a=s("e9bc"),i=s("5320"),r=s("dad2"),o=!r("union")||!i("union");n({target:"Set",proto:!0,real:!0,forced:o},{union:a})},"79a4":function(e,t,s){"use strict";var n=s("23e7"),a=s("d039"),i=s("953b"),r=s("dad2"),o=!r("intersection",(function(e){return 2===e.size&&e.has(1)&&e.has(2)}))||a((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}));n({target:"Set",proto:!0,real:!0,forced:o},{intersection:i})},"7f65":function(e,t,s){"use strict";var n=s("59ed"),a=s("825a"),i=s("c65b"),r=s("5926"),o=s("46c4"),c="Invalid size",l=RangeError,u=TypeError,d=Math.max,f=function(e,t){this.set=e,this.size=d(t,0),this.has=n(e.has),this.keys=n(e.keys)};f.prototype={getIterator:function(){return o(a(i(this.keys,this.set)))},includes:function(e){return i(this.has,this.set,e)}},e.exports=function(e){a(e);var t=+e.size;if(t!==t)throw new u(c);var s=r(t);if(s<0)throw new l(c);return new f(e,s)}},"83b9":function(e,t,s){"use strict";var n=s("cb27"),a=s("384f"),i=n.Set,r=n.add;e.exports=function(e){var t=new i;return a(e,(function(e){r(t,e)})),t}},"88a7":function(e,t,s){"use strict";var n=s("cb2d"),a=s("e330"),i=s("577e"),r=s("d6d6"),o=URLSearchParams,c=o.prototype,l=a(c.append),u=a(c["delete"]),d=a(c.forEach),f=a([].push),v=new o("a=1&a=2&b=3");v["delete"]("a",1),v["delete"]("b",void 0),v+""!=="a=2"&&n(c,"delete",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return u(this,e);var n=[];d(this,(function(e,t){f(n,{key:t,value:e})})),r(t,1);var a,o=i(e),c=i(s),v=0,h=0,m=!1,b=n.length;while(v<b)a=n[v++],m||a.key===o?(m=!0,u(this,a.key)):h++;while(h<b)a=n[h++],a.key===o&&a.value===c||l(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},"8b00":function(e,t,s){"use strict";var n=s("23e7"),a=s("68df"),i=s("dad2"),r=!i("isSubsetOf",(function(e){return e}));n({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:a})},"8e16":function(e,t,s){"use strict";var n=s("7282"),a=s("cb27");e.exports=n(a.proto,"size","get")||function(e){return e.size}},"953b":function(e,t,s){"use strict";var n=s("dc19"),a=s("cb27"),i=s("8e16"),r=s("7f65"),o=s("384f"),c=s("5388"),l=a.Set,u=a.add,d=a.has;e.exports=function(e){var t=n(this),s=r(e),a=new l;return i(t)>s.size?c(s.getIterator(),(function(e){d(t,e)&&u(a,e)})):o(t,(function(e){s.includes(e)&&u(a,e)})),a}},9961:function(e,t,s){"use strict";var n=s("dc19"),a=s("cb27"),i=s("83b9"),r=s("7f65"),o=s("5388"),c=a.add,l=a.has,u=a.remove;e.exports=function(e){var t=n(this),s=r(e).getIterator(),a=i(t);return o(s,(function(e){l(t,e)?u(a,e):c(a,e)})),a}},a4e7:function(e,t,s){"use strict";var n=s("23e7"),a=s("395e"),i=s("dad2"),r=!i("isSupersetOf",(function(e){return!e}));n({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:a})},a5f7:function(e,t,s){"use strict";var n=s("dc19"),a=s("cb27"),i=s("83b9"),r=s("8e16"),o=s("7f65"),c=s("384f"),l=s("5388"),u=a.has,d=a.remove;e.exports=function(e){var t=n(this),s=o(e),a=i(t);return r(t)<=s.size?c(t,(function(e){s.includes(e)&&d(a,e)})):l(s.getIterator(),(function(e){u(a,e)&&d(a,e)})),a}},b4bc:function(e,t,s){"use strict";var n=s("dc19"),a=s("cb27").has,i=s("8e16"),r=s("7f65"),o=s("384f"),c=s("5388"),l=s("2a62");e.exports=function(e){var t=n(this),s=r(e);if(i(t)<=s.size)return!1!==o(t,(function(e){if(s.includes(e))return!1}),!0);var u=s.getIterator();return!1!==c(u,(function(e){if(a(t,e))return l(u,"normal",!1)}))}},c1a18:function(e,t,s){"use strict";var n=s("23e7"),a=s("b4bc"),i=s("dad2"),r=!i("isDisjointFrom",(function(e){return!e}));n({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:a})},cb27:function(e,t,s){"use strict";var n=s("e330"),a=Set.prototype;e.exports={Set:Set,add:n(a.add),has:n(a.has),remove:n(a["delete"]),proto:a}},d6d6:function(e,t,s){"use strict";var n=TypeError;e.exports=function(e,t){if(e<t)throw new n("Not enough arguments");return e}},dad2:function(e,t,s){"use strict";var n=s("d066"),a=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},i=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}};e.exports=function(e,t){var s=n("Set");try{(new s)[e](a(0));try{return(new s)[e](a(-1)),!1}catch(o){if(!t)return!0;try{return(new s)[e](i(-1/0)),!1}catch(c){var r=new s([1,2]);return t(r[e](i(1/0)))}}}catch(c){return!1}}},dc19:function(e,t,s){"use strict";var n=s("cb27").has;e.exports=function(e){return n(e),e}},e4bb:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"history"},[t("NavBar"),t("div",{staticClass:"history-container"},[t("h2",[e._v("Evolution History")]),e.stats.sessionCount>0?t("p",{staticClass:"history-stats"},[e._v(" "+e._s(e.stats.sessionCount)+" mutation sessions, "+e._s(e.stats.imageCount)+" total images ("+e._s(e.stats.sizeKB)+"KB used) ")]):e._e(),t("div",{staticClass:"history-controls"},[t("button",{staticClass:"btn btn-primary btn-sm",on:{click:e.exportToFile}},[e._v(" Export to File ")]),t("label",{staticClass:"btn btn-secondary btn-sm import-btn"},[e._v(" Import from File "),t("input",{attrs:{type:"file",accept:".json",hidden:""},on:{change:e.importFromFile}})]),e.sessions.length>0?t("button",{staticClass:"btn btn-danger btn-sm",on:{click:e.confirmClearAll}},[e._v(" Clear All History ")]):e._e()]),t("div",{staticClass:"autosave-controls"},[t("span",{staticClass:"autosave-label"},[e._v("Auto-save JSON to disk:")]),e.hasSaveFolder?t("span",{staticClass:"autosave-status"},[e._v(" Enabled "),t("button",{staticClass:"btn btn-outline-secondary btn-sm",on:{click:e.changeSaveFolder}},[e._v("Change")]),t("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:e.disableAutoSave}},[e._v("Disable")])]):t("button",{staticClass:"btn btn-success btn-sm",on:{click:e.selectSaveFolder}},[e._v(" Select Folder ")])]),t("div",{staticClass:"autosave-controls"},[t("span",{staticClass:"autosave-label"},[e._v("Auto-save images (PNG):")]),e.hasImagesFolder?t("span",{staticClass:"autosave-status"},[e._v(" Enabled (session subfolders) "),t("button",{staticClass:"btn btn-outline-secondary btn-sm",on:{click:e.changeImagesFolder}},[e._v("Change")]),t("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:e.disableImagesSave}},[e._v("Disable")])]):t("button",{staticClass:"btn btn-success btn-sm",on:{click:e.selectImagesFolder}},[e._v(" Select Images Folder ")])]),e.sessions.length>0?t("div",{staticClass:"sessions-list"},e._l(e.sessions,(function(s){return t("div",{key:s.id,staticClass:"session-card"},[t("div",{staticClass:"session-header"},[t("span",{staticClass:"session-date"},[e._v(e._s(e.formatDateTime(s.timestamp)))]),t("span",{staticClass:"session-count"},[e._v(e._s(s.images.length)+" parent"+e._s(s.images.length>1?"s":""))]),t("button",{staticClass:"delete-session-btn",on:{click:function(t){return e.deleteSession(s.id)}}},[e._v("Delete Session")])]),t("div",{staticClass:"session-images"},e._l(s.images,(function(n){return t("div",{key:n.id,staticClass:"session-image",on:{click:function(t){return e.selectImage(s,n)}}},[t("img",{attrs:{src:n.thumbnail,alt:"Parent image"}}),t("button",{staticClass:"delete-img-btn",on:{click:function(t){return t.stopPropagation(),e.deleteImage(s.id,n.id)}}},[e._v("x")])])})),0)])})),0):t("div",{staticClass:"history-empty"},[t("p",[e._v("No saved images yet.")]),t("p",[e._v("Select images in the "),t("router-link",{attrs:{to:"/evolve"}},[e._v("Evolve")]),e._v(' page and click "mutate" to save them automatically.')],1)]),e.selectedImage?t("div",{staticClass:"history-modal",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeModal.apply(null,arguments)}}},[t("div",{staticClass:"modal-content"},[t("button",{staticClass:"close-btn",on:{click:e.closeModal}},[e._v("x")]),t("img",{staticClass:"modal-image",attrs:{src:e.selectedImage.thumbnail}}),t("div",{staticClass:"modal-info"},[t("p",[t("strong",[e._v("Session:")]),e._v(" "+e._s(e.formatDateTime(e.selectedSession.timestamp)))]),t("p",[t("strong",[e._v("Image ID:")]),e._v(" "+e._s(e.selectedImage.id))])]),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn btn-success",on:{click:e.loadIntoEvolve}},[e._v(" Load into Evolve ")]),t("button",{staticClass:"btn btn-info",on:{click:e.downloadImage}},[e._v(" Download PNG ")]),t("button",{staticClass:"btn btn-secondary",on:{click:e.copyGenome}},[e._v(" Copy Genome JSON ")]),t("button",{staticClass:"btn btn-danger",on:{click:e.deleteAndClose}},[e._v(" Delete ")])])])]):e._e()]),t("Footer")],1)},a=[],i=(s("14d9"),s("e9f5"),s("910d"),s("ab43"),s("e9c4"),s("1e70"),s("79a4"),s("c1a18"),s("8b00"),s("a4e7"),s("1e5a"),s("72c3"),s("5087"),s("88a7"),s("271a"),s("5494"),s("d000")),r=s("fd2d"),o=s("05e5"),c={name:"History",components:{NavBar:i["a"],Footer:r["a"]},data(){return{sessions:[],stats:{sessionCount:0,imageCount:0,sizeKB:0},selectedSession:null,selectedImage:null,hasSaveFolder:!1,hasImagesFolder:!1}},async mounted(){this.loadSessions(),this.hasSaveFolder=await o["a"].hasSaveFolder(),this.hasImagesFolder=await o["a"].hasImagesFolder()},methods:{loadSessions(){this.sessions=o["a"].getAll(),this.stats=o["a"].getStats()},async selectSaveFolder(){const e=await o["a"].selectSaveFolder();e&&(this.hasSaveFolder=!0,await o["a"].saveToFile(),alert("Auto-save folder set! History will be saved to picbreeder-history.json in the selected folder."))},async changeSaveFolder(){await this.selectSaveFolder()},async disableAutoSave(){await o["a"].clearSaveFolder(),this.hasSaveFolder=!1},async selectImagesFolder(){const e=await o["a"].selectImagesFolder();e&&(this.hasImagesFolder=!0,alert("Images folder set! Each mutation will save PNG images to session subfolders."))},async changeImagesFolder(){await this.selectImagesFolder()},async disableImagesSave(){await o["a"].clearImagesFolder(),this.hasImagesFolder=!1},formatDate(e){return new Date(e).toLocaleDateString()},formatDateTime(e){return new Date(e).toLocaleString()},selectImage(e,t){this.selectedSession=e,this.selectedImage=t},closeModal(){this.selectedSession=null,this.selectedImage=null},deleteSession(e){confirm("Delete this entire mutation session?")&&(o["a"].deleteSession(e),this.loadSessions())},deleteImage(e,t){confirm("Delete this image?")&&(o["a"].deleteImage(e,t),this.loadSessions())},deleteAndClose(){this.selectedImage&&this.selectedSession&&(o["a"].deleteImage(this.selectedSession.id,this.selectedImage.id),this.closeModal(),this.loadSessions())},confirmClearAll(){confirm("Delete ALL saved images? This cannot be undone.")&&(o["a"].clearAll(),this.loadSessions())},loadIntoEvolve(){sessionStorage.setItem("picbreeder_load_genome",JSON.stringify(this.selectedImage.genome)),this.$router.push("/evolve")},downloadImage(){const e=document.createElement("a");e.download=`picbreeder-${this.selectedImage.id}.png`,e.href=this.selectedImage.thumbnail,e.click()},copyGenome(){const e=JSON.stringify(this.selectedImage.genome,null,2);navigator.clipboard.writeText(e).then(()=>{alert("Genome JSON copied to clipboard!")})},exportToFile(){const e=o["a"].getAll(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.download=`picbreeder-history-${(new Date).toISOString().slice(0,10)}.json`,n.href=s,n.click(),URL.revokeObjectURL(s)},importFromFile(e){const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=e=>{try{const t=JSON.parse(e.target.result);if(!Array.isArray(t))return void alert("Invalid file format");const s=t.filter(e=>e&&e.id&&e.timestamp&&Array.isArray(e.images));if(0===s.length)return void alert("No valid sessions found in file");const n=o["a"].getAll(),a=new Set(n.map(e=>e.id)),i=s.filter(e=>!a.has(e.id)),r=[...i,...n];r.sort((e,t)=>t.timestamp-e.timestamp),localStorage.setItem("picbreeder_history",JSON.stringify(r)),this.loadSessions(),alert(`Imported ${i.length} new session(s)`)}catch(t){alert("Error reading file: "+t.message)}},s.readAsText(t),e.target.value=""}}},l=c,u=(s("02b6"),s("2877")),d=Object(u["a"])(l,n,a,!1,null,"f4dadf00",null);t["default"]=d.exports},e9bc:function(e,t,s){"use strict";var n=s("dc19"),a=s("cb27").add,i=s("83b9"),r=s("7f65"),o=s("5388");e.exports=function(e){var t=n(this),s=r(e).getIterator(),c=i(t);return o(s,(function(e){a(c,e)})),c}}}]);
//# sourceMappingURL=history.8dc4b3c9.js.map